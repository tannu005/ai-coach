{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/YTANNU/Favorites/ai.coach/action/dashboard.js"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from \"@/lib/prisma\";\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\nconst genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);\r\nconst model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\r\n\r\nexport const generateAIInsights = async (industry) => {\r\n    const prompt = `\r\n          Analyze the current state of the ${industry} industry and provide insights in ONLY the following JSON format without any additional notes or explanations:\r\n          {\r\n            \"salaryRanges\": [\r\n              { \"role\": \"string\", \"min\": number, \"max\": number, \"median\": number, \"location\": \"string\" }\r\n            ],\r\n            \"growthRate\": number,\r\n            \"demandLevel\": \"High\" | \"Medium\" | \"Low\",\r\n            \"topSkills\": [\"skill1\", \"skill2\"],\r\n            \"marketOutlook\": \"Positive\" | \"Neutral\" | \"Negative\",\r\n            \"keyTrends\": [\"trend1\", \"trend2\"],\r\n            \"recommendedSkills\": [\"skill1\", \"skill2\"]\r\n          }\r\n          \r\n          IMPORTANT: Return ONLY the JSON. No additional text, notes, or markdown formatting.\r\n          Include at least 5 common roles for salary ranges.\r\n          Growth rate should be a percentage.\r\n          Include at least 5 skills and trends.\r\n        `;\r\n\r\n    const result = await model.generateContent(prompt);\r\n    const response = result.response;\r\n    const text = response.text();\r\n    const cleanedText = text.replace(/```(?:json)?\\n?/g, \"\").trim();\r\n\r\n    return JSON.parse(cleanedText);\r\n};\r\n\r\nexport async function getIndustryInsights() {\r\n    const { userId } = await auth();\r\n    if (!userId) throw new Error(\"Unauthorized\");\r\n\r\n    const user = await db.user.findUnique({\r\n        where: { clerkUserId: userId },\r\n        include: {\r\n            industryInsight: true,\r\n        },\r\n    });\r\n\r\n    if (!user) throw new Error(\"User not found\");\r\n\r\n    // If no insights exist, generate them\r\n    if (!user.industryInsight) {\r\n        const insights = await generateAIInsights(user.industry);\r\n\r\n        const industryInsight = await db.industryInsight.create({\r\n            data: {\r\n                industry: user.industry,\r\n                ...insights,\r\n                nextUpdate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),\r\n            },\r\n        });\r\n\r\n        return industryInsight;\r\n    }\r\n\r\n    return user.industryInsight;\r\n}"],"names":[],"mappings":";;;;;;;;AAEA;AACA;AACA;;;;;;;AAEA,MAAM,QAAQ,IAAI,oLAAkB,CAAC,QAAQ,GAAG,CAAC,cAAc;AAC/D,MAAM,QAAQ,MAAM,kBAAkB,CAAC;IAAE,OAAO;AAAmB;AAE5D,MAAM,qBAAqB,OAAO;IACrC,MAAM,SAAS,CAAC;2CACuB,EAAE,SAAS;;;;;;;;;;;;;;;;;QAiB9C,CAAC;IAEL,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;IAC3C,MAAM,WAAW,OAAO,QAAQ;IAChC,MAAM,OAAO,SAAS,IAAI;IAC1B,MAAM,cAAc,KAAK,OAAO,CAAC,oBAAoB,IAAI,IAAI;IAE7D,OAAO,KAAK,KAAK,CAAC;AACtB;AAEO,eAAe;IAClB,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,2LAAI;IAC7B,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;IAE7B,MAAM,OAAO,MAAM,mHAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QAClC,OAAO;YAAE,aAAa;QAAO;QAC7B,SAAS;YACL,iBAAiB;QACrB;IACJ;IAEA,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,sCAAsC;IACtC,IAAI,CAAC,KAAK,eAAe,EAAE;QACvB,MAAM,WAAW,MAAM,mBAAmB,KAAK,QAAQ;QAEvD,MAAM,kBAAkB,MAAM,mHAAE,CAAC,eAAe,CAAC,MAAM,CAAC;YACpD,MAAM;gBACF,UAAU,KAAK,QAAQ;gBACvB,GAAG,QAAQ;gBACX,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;YACzD;QACJ;QAEA,OAAO;IACX;IAEA,OAAO,KAAK,eAAe;AAC/B;;;IA1Da;IA6BS;;AA7BT,+OAAA;AA6BS,+OAAA","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/YTANNU/Favorites/ai.coach/action/user.js"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from \"@/lib/prisma\";\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\nimport { generateAIInsights } from \"./dashboard\";\r\n\r\nexport async function updateUser(data) {\r\n    const { userId } = await auth();\r\n    if (!userId) throw new Error(\"Unauthorized\");\r\n\r\n    const user = await db.user.findUnique({\r\n        where: { clerkUserId: userId },\r\n    });\r\n\r\n    if (!user) throw new Error(\"User not found\");\r\n\r\n    try {\r\n        // Start a transaction to handle both operations\r\n        const result = await db.$transaction(\r\n            async (tx) => {\r\n                // First check if industry exists\r\n                let industryInsight = await tx.industryInsight.findUnique({\r\n                    where: {\r\n                        industry: data.industry,\r\n                    },\r\n                });\r\n\r\n                // If industry doesn't exist, create it with default values\r\n                if (!industryInsight) {\r\n                    const insights = await generateAIInsights(data.industry);\r\n\r\n                    industryInsight = await db.industryInsight.create({\r\n                        data: {\r\n                            industry: data.industry,\r\n                            ...insights,\r\n                            nextUpdate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),\r\n                        },\r\n                    });\r\n                }\r\n\r\n                // Now update the user\r\n                const updatedUser = await tx.user.update({\r\n                    where: {\r\n                        id: user.id,\r\n                    },\r\n                    data: {\r\n                        industry: data.industry,\r\n                        experience: data.experience,\r\n                        bio: data.bio,\r\n                        skills: data.skills,\r\n                    },\r\n                });\r\n\r\n                return { updatedUser, industryInsight };\r\n            },\r\n            {\r\n                timeout: 10000, // default: 5000\r\n            }\r\n        );\r\n\r\n        revalidatePath(\"/\");\r\n        return result.user;\r\n    } catch (error) {\r\n        console.error(\"Error updating user and industry:\", error.message);\r\n        throw new Error(\"Failed to update profile\");\r\n    }\r\n}\r\n\r\nexport async function getUserOnboardingStatus() {\r\n    const { userId } = await auth();\r\n    if (!userId) throw new Error(\"Unauthorized\");\r\n\r\n    const user = await db.user.findUnique({\r\n        where: { clerkUserId: userId },\r\n    });\r\n\r\n    if (!user) throw new Error(\"User not found\");\r\n\r\n    try {\r\n        const user = await db.user.findUnique({\r\n            where: {\r\n                clerkUserId: userId,\r\n            },\r\n            select: {\r\n                industry: true,\r\n            },\r\n        });\r\n\r\n        return {\r\n            isOnboarded: !!user?.industry,\r\n        };\r\n    } catch (error) {\r\n        console.error(\"Error checking onboarding status:\", error);\r\n        throw new Error(\"Failed to check onboarding status\");\r\n    }\r\n}"],"names":[],"mappings":";;;;;;;;AAEA;AACA;AACA;AACA;;;;;;;;AAEO,eAAe,WAAW,IAAI;IACjC,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,2LAAI;IAC7B,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;IAE7B,MAAM,OAAO,MAAM,mHAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QAClC,OAAO;YAAE,aAAa;QAAO;IACjC;IAEA,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,IAAI;QACA,gDAAgD;QAChD,MAAM,SAAS,MAAM,mHAAE,CAAC,YAAY,CAChC,OAAO;YACH,iCAAiC;YACjC,IAAI,kBAAkB,MAAM,GAAG,eAAe,CAAC,UAAU,CAAC;gBACtD,OAAO;oBACH,UAAU,KAAK,QAAQ;gBAC3B;YACJ;YAEA,2DAA2D;YAC3D,IAAI,CAAC,iBAAiB;gBAClB,MAAM,WAAW,MAAM,IAAA,yIAAkB,EAAC,KAAK,QAAQ;gBAEvD,kBAAkB,MAAM,mHAAE,CAAC,eAAe,CAAC,MAAM,CAAC;oBAC9C,MAAM;wBACF,UAAU,KAAK,QAAQ;wBACvB,GAAG,QAAQ;wBACX,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;oBACzD;gBACJ;YACJ;YAEA,sBAAsB;YACtB,MAAM,cAAc,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gBACrC,OAAO;oBACH,IAAI,KAAK,EAAE;gBACf;gBACA,MAAM;oBACF,UAAU,KAAK,QAAQ;oBACvB,YAAY,KAAK,UAAU;oBAC3B,KAAK,KAAK,GAAG;oBACb,QAAQ,KAAK,MAAM;gBACvB;YACJ;YAEA,OAAO;gBAAE;gBAAa;YAAgB;QAC1C,GACA;YACI,SAAS;QACb;QAGJ,IAAA,+IAAc,EAAC;QACf,OAAO,OAAO,IAAI;IACtB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,qCAAqC,MAAM,OAAO;QAChE,MAAM,IAAI,MAAM;IACpB;AACJ;AAEO,eAAe;IAClB,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAA,2LAAI;IAC7B,IAAI,CAAC,QAAQ,MAAM,IAAI,MAAM;IAE7B,MAAM,OAAO,MAAM,mHAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QAClC,OAAO;YAAE,aAAa;QAAO;IACjC;IAEA,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;IAE3B,IAAI;QACA,MAAM,OAAO,MAAM,mHAAE,CAAC,IAAI,CAAC,UAAU,CAAC;YAClC,OAAO;gBACH,aAAa;YACjB;YACA,QAAQ;gBACJ,UAAU;YACd;QACJ;QAEA,OAAO;YACH,aAAa,CAAC,CAAC,MAAM;QACzB;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,qCAAqC;QACnD,MAAM,IAAI,MAAM;IACpB;AACJ;;;IAzFsB;IA8DA;;AA9DA,+OAAA;AA8DA,+OAAA","debugId":null}},
    {"offset": {"line": 219, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/YTANNU/Favorites/ai.coach/app/%28main%29/dashboard/component/dashboard-view.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/dashboard/component/dashboard-view.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/dashboard/component/dashboard-view.jsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAqT,GAClV,mFACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 233, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/YTANNU/Favorites/ai.coach/app/%28main%29/dashboard/component/dashboard-view.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/dashboard/component/dashboard-view.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/dashboard/component/dashboard-view.jsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAiS,GAC9T,+DACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 247, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/YTANNU/Favorites/ai.coach/app/%28main%29/dashboard/page.jsx"],"sourcesContent":["import { getIndustryInsights } from \"@/action/dashboard\";\r\nimport DashboardView from \"./component/dashboard-view\";\r\nimport { getUserOnboardingStatus } from \"@/action/user\";\r\nimport { redirect } from \"next/navigation\";\r\n\r\nexport default async function DashboardPage() {\r\n    const { isOnboarded } = await getUserOnboardingStatus();\r\n\r\n    // If not onboarded, redirect to onboarding page\r\n    // Skip this check if already on the onboarding page\r\n    if (!isOnboarded) {\r\n        redirect(\"/onboarding\");\r\n    }\r\n\r\n    const insights = await getIndustryInsights();\r\n\r\n    return (\r\n        <div className=\"container mx-auto\">\r\n            <DashboardView insights={insights} />\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AAAA;;;;;;AAEe,eAAe;IAC1B,MAAM,EAAE,WAAW,EAAE,GAAG,MAAM,IAAA,yIAAuB;IAErD,gDAAgD;IAChD,oDAAoD;IACpD,IAAI,CAAC,aAAa;QACd,IAAA,iMAAQ,EAAC;IACb;IAEA,MAAM,WAAW,MAAM,IAAA,0IAAmB;IAE1C,qBACI,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC,0KAAa;YAAC,UAAU;;;;;;;;;;;AAGrC","debugId":null}}]
}